# バナー画像レイヤー分解アプリケーション 共通仕様書

## 概要
既存のバナー画像（画像と文字が混在）を入力として、以下の3つのレイヤーに自動分解するローカル動作アプリケーションを開発してください。

### 出力レイヤー
1. **文字レイヤー**: 文字部分のみ、同一位置・同一サイズ、背景透過PNG
2. **背景レイヤー**: 文字と被写体を除去した背景のみ
3. **被写体レイヤー**: 商品画像や人物など主要な被写体のみ、背景透過PNG

**重要**: 3つのレイヤーを重ね合わせると元画像と完全に一致すること

## 技術要件

### 必須要件
- **開発手法**: Test-Driven Development (TDD) - テストを先に書いてから実装
- **言語**: Python 3.10+ (バックエンド)
- **フレームワーク**: FastAPI (バックエンド)、任意のフロントエンド
- **コンテナ**: Docker/Docker Compose
- **ローカル動作**: 外部APIに依存しない

### 推奨技術（変更可）
- OCR: Tesseract または同等のライブラリ
- 物体検出: YOLO、SAM、または同等のモデル
- 背景生成: インペイント技術（OpenCV、深層学習モデル等）
- フロントエンド: React、Vue、または単純なHTML/JS

## 機能要件

### 1. 画像アップロード
- PNG/JPG形式をサポート
- ドラッグ&ドロップまたはファイル選択
- 最大ファイルサイズ: 10MB
- アップロード時のプレビュー表示

### 2. 自動レイヤー分解処理
- **文字検出**: 日本語・英語の文字を検出し、マスクを生成
- **被写体検出**: 主要な物体（商品、人物等）を検出し、マスクを生成
- **背景生成**: 文字と被写体の領域を自然に補完（インペイント）
- **進捗表示**: 処理の進行状況を表示

### 3. 結果出力
- 3つのPNGファイルを個別にダウンロード可能
- ZIPファイルでの一括ダウンロード
- プレビュー機能（各レイヤーの確認）
- レイヤー重ね合わせの確認機能

## 実装上の制約と自由度

### 制約
- ローカルで完結すること（クラウドAPI不使用）
- TDDに従うこと
- Dockerで動作すること

### 自由度
- UI/UXデザインは自由
- 具体的なAIモデルの選択は自由
- ディレクトリ構造は自由（ただし整理されていること）
- 追加機能の実装は歓迎

## 成果物

### 必須成果物
1. 完全に動作するアプリケーション
2. Dockerfile と docker-compose.yml
3. テストコード（カバレッジ80%以上目標）
4. README.md（セットアップと使用方法）
5. 実装の工夫点をまとめたドキュメント

### コード品質
- PEP8準拠（Python）
- 適切なエラーハンドリング
- ログ出力
- 型ヒントの使用

## 評価基準

1. **機能完成度** (40%)
   - 3つのレイヤーが正しく生成される
   - レイヤーを重ねると元画像になる
   - エッジケースへの対応

2. **コード品質** (30%)
   - TDDの実践度
   - コードの可読性
   - アーキテクチャの設計

3. **性能** (20%)
   - 処理速度
   - メモリ効率
   - 画像品質

4. **独自性** (10%)
   - 創意工夫
   - UI/UXの使いやすさ
   - 追加機能

## 開発の進め方

1. 要件の理解と設計
2. プロジェクト構造の作成
3. TDDサイクル:
   - テストケースの作成
   - 最小限の実装
   - リファクタリング
4. 統合とデバッグ
5. ドキュメント作成

## 質問と報告

実装中の以下の点について報告してください：

1. **設計決定**
   - 使用するAIモデルとその理由
   - アーキテクチャの選択理由
   - 工夫した点

2. **実装状況**
   - 完了した機能
   - 直面した課題と解決方法
   - テストカバレッジ

3. **デモ**
   - サンプル画像での動作確認
   - 処理時間の測定結果
   - 特徴的な機能の説明

## 参考リソース

- specification.yaml（詳細な技術仕様）
- TDD: https://en.wikipedia.org/wiki/Test-driven_development
- FastAPI: https://fastapi.tiangolo.com/
- 画像処理の基礎知識があると想定

---

**注意**: 
- 実装方法は自由ですが、要件を満たすことが最優先
- 不明な点があれば質問してください
- 定期的に進捗を報告してください